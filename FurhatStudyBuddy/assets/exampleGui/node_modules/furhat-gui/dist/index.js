"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Furhat = void 0;
const furhat_core_1 = __importDefault(require("furhat-core"));
exports.Furhat = furhat_core_1.default;
let furhat;
let portNumber;
/**
 * FurhatGUI Function which sets up a connection to the furhat skill and gives
 * the furhat object to send and recieve events to the skill.
 * @return Promise that will return the promise with a `Furhat` obkect
 */
const FurhatGUI = () => new Promise((resolve, reject) => {
    window.fetch('/port', { method: 'GET' }) // eslint-disable-line no-undef
        .then(r => r.json())
        .then(({ address, port }) => {
        portNumber = port;
        furhat = new furhat_core_1.default(address, port, 'api');
        return furhat.init();
    })
        .then(() => {
        const senseSkillGuiEvent = {
            event_name: 'furhatos.event.senses.SenseSkillGUIConnected',
            port: portNumber,
        };
        furhat.send(senseSkillGuiEvent);
        resolve(furhat);
    })
        .catch((error) => reject(`Something went wrong: ${error}`));
});
exports.default = FurhatGUI;
